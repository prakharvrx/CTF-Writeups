# Description
Your cybersecurity team is investigating a suspicious browser extension called "ChatGPT" that employees installed. After installation, unusual browser behavior was observed, including account compromises and potential data leaks. The task is to perform a detailed analysis of the extension to identify its malicious components, including mechanisms for stealing data, covert exfiltration, and any anti-analysis techniques.

# Tactics
`Credential Access`  , `Collection`  ,  `Command and Control`  , `Exfiltration` 

# Tools
`VS Code` 

# Chrome Extension Anatomy
### 1. Web-Accessible Resources
These are internal files that websites can access. Normally used for images or scripts, but attackers hide malicious payloads here or leak sensitive data through them.
### 2. `manifest.json`
This is the extension's blueprint. It declares what the extension can do:
- **Permissions**: access tabs, cookies, storage, network, etc.
- **Host permission**: which websites it can read or modify.
- **Content scripts**: what scripts get injected into webpages.
A malicious extension usually request overbroad permissions to gain maximum controls.
### 3. Content Scripts
These run inside webpages and can directly interact with what the user sees/
They enable:
- **Data theft**: reading form inputs, scraping content, capturing keystrokes
- **Page manipulation**: injecting fake elements, altering behavior
This is one of the most dangerous components when abused.
### 4. Popup Scripts
This is the code behind the UI that appears when clicking the extension icon.
Attackers use it to trigger malicious actions, hide signs of compromise, or mislead users with fake status messages.
### 5. Background Scripts
These run in the background continuously, listening to events like tab changes or network activity.
Malicious extensions use background scripts or browser monitoring, command and control, and coordinating data exfiltration.
### 6. External Resources
Extensions can fetch code or data from the internet. This is often abused to load:
- Malicious domains
- Obfuscated payloads
- Dynamic scripts that bypass static analysis
This allows attackers to update or hide their behavior

# Questions & Answers
### 1. Which encoding method does the browser extension use to obscure target URLs, making them more difficult to detect during analysis?
![[question1.png]]Answer: `base64`

### 2. Which website does the extension monitor for data theft, targeting user accounts to steal sensitive information?
Answer: `www.facebook.com`

### 3. Which type of HTML element is utilized by the extension to send stolen data?
![[question3.png]]Answer: `<img>`

### 4. What is the first specific condition in the code that triggers the extension to deactivate itself?
![[question4.png]]Answer: `navigator.plugins.length === 0`

### 5. Which event does the extension capture to track user input submitted through forms?
![[question5.png]]Answer: `submit`

### 6. Which API or method does the extension use to capture and monitor user keystrokes?
![[question6.png]]Answer: `keydown`

### 7. What is the domain where the extension transmits the exfiltrated data?
![[question7.png]]Answer: `Mo.Elshaheedy.com`

### 8. Which function in the code is used to exfiltrate user credentials, including the username and password?
![[question8.png]]Answer: `exfiltrateCredentials(username, password);`

### 9. Which encryption algorithm is applied to secure the data before sending?
![[question9.png]]Answer: `AES`

### 10. What does the extension access to store or manipulate session-related data and authentication information?
![[question10.png]]
Answer: `cookies`

